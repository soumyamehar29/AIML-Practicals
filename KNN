import pandas as pd
import numpy as np

from google.colab import files
uploaded = files.upload()

df = pd.read_csv('Social_Network_Ads.csv')
df.head()

X = df[['Age', 'EstimatedSalary']]
y = df['Purchased']

# Split Data into Training and Testing Sets
from sklearn.model_selection import train_test_split


X_train, X_test, y_train, y_test = train_test_split(X, y, test_size = 0.30, random_state=42)

#Handle Missing Values (if any)
from sklearn.impute import SimpleImputer

imputer = SimpleImputer(missing_values=np.nan, strategy='mean')

imputer.fit(X_train[['Age', 'EstimatedSalary']])

X_train[['Age', 'EstimatedSalary']] = imputer.transform(X_train[['Age', 'EstimatedSalary']])

X_test[['Age', 'EstimatedSalary']] = imputer.transform(X_test[['Age', 'EstimatedSalary']])

# Feature Scaling (KNN is distance-based, scaling is important)
from sklearn.preprocessing import MinMaxScaler
scaler = MinMaxScaler()

scaler.fit(X_train)

X_train = scaler.transform(X_train)
X_test = scaler.transform(X_test)

#Import and Train KNN Model
from sklearn.neighbors import KNeighborsClassifier

knn = KNeighborsClassifier(n_neighbors=5)
knn.fit(X_train, y_train)



# Evaluate Model Accuracy
train_acc = knn.score(X_train, y_train)
test_acc = knn.score(X_test, y_test)

print("Training Accuracy:", train_acc)
print("Testing Accuracy:", test_acc)

#predict and display confusion matrix
from sklearn.metrics import confusion_matrix, classification_report

y_pred = knn.predict(X_test)

cm = confusion_matrix(y_test, y_pred)

print("\nConfusion Matrix:\n", cm)

print("\nClassification Report:\n", classification_report(y_test, y_pred))
